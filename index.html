<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>แบบสอบถาม</title>

<style>
body{
  margin:0;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  font-family:sans-serif;
  background:#f3f4f6;
  overflow:hidden;
}
.card{
  background:white;
  width:360px;
  padding:28px;
  border-radius:22px;
  text-align:center;
  box-shadow:0 10px 40px rgba(0,0,0,.15);
  position:relative;
}
button{
  width:100%;
  padding:14px;
  margin-top:10px;
  border:none;
  border-radius:999px;
  font-size:16px;
  cursor:pointer;
}
.option{background:#6366f1;color:white}

/* loading */
.spinner{
  width:50px;height:50px;
  border:5px solid #ddd;
  border-top:5px solid #ff4d8d;
  border-radius:50%;
  margin:20px auto;
  animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}

/* love mode */
.love-bg{
  background:linear-gradient(135deg,#ff9acb,#ffd6e8);
}
.love-btn{background:#ff4d8d;color:white}
.no-btn{
  background:#9ca3af;
  color:white;
  position:absolute;
  left:50%;
  transform:translateX(-50%);
}

/* hearts float */
.heart{
  position:absolute;
  color:#ff4d8d;
  pointer-events:none;
}

/* ลอย */
@keyframes float{
  0%{transform:translateY(0) scale(0);opacity:1}
  30%{transform:translateY(-40vh) scale(1.4)}
  100%{transform:translateY(-90vh) scale(0.8);opacity:0}
}

/* ระเบิด */
@keyframes burst{
  0%{transform:translate(0,0) scale(0)}
  100%{
    transform:
      translate(var(--x),var(--y))
      rotate(360deg)
      scale(1.2);
    opacity:0;
  }
}
</style>
</head>

<body>
<div class="card" id="card"></div>

<script>
const card=document.getElementById("card");

/* หัวใจลอยพื้นหลัง */
function spawnHearts(){
  setInterval(()=>{
    for(let i=0;i<3;i++){
      const h=document.createElement("div");
      h.className="heart";
      h.innerText="❤";
      h.style.left=Math.random()*100+"vw";
      h.style.fontSize=28+Math.random()*28+"px";
      h.style.animation="float 4s linear forwards";
      document.body.appendChild(h);
      setTimeout(()=>h.remove(),4000);
    }
  },300);
}

/* page 1 */
function start(){
  card.innerHTML=`
    <h2>แบบสอบถาม</h2>
    <p>พร้อมเริ่มหรือยัง</p>
    <button class="option" onclick="aiPage()">เริ่ม</button>
  `;
}
start();

/* AI page */
const aiQuestions=[
"AI ช่วยค้นหาข้อมูลได้ไหม?",
"AI ช่วยทำการบ้านได้ไหม?",
"AI เขียนรายงานได้ไหม?",
"AI วาดภาพได้ไหม?",
"AI แต่งเพลงได้ไหม?",
"AI แทนมนุษย์ได้ทั้งหมดหรือไม่?",
"AI ตัดต่อวิดีโอได้ไหม?",
"AI แปลภาษาได้ไหม?",
"AI คิดเองเหมือนคนได้ไหม?",
"AI ตัดสินใจแทนเราได้ไหม?"
];
let aiIndex=0;

function aiPage(){renderAI();}
function renderAI(){
  card.innerHTML=`
    <div>${aiIndex+1} / ${aiQuestions.length}</div>
    <h3>${aiQuestions[aiIndex]}</h3>
    <button class="option" onclick="nextAI()">ได้</button>
    <button class="option" onclick="nextAI()">ได้บ้าง</button>
    <button class="option" onclick="nextAI()">ไม่ได้</button>
  `;
}
function nextAI(){
  aiIndex++;
  aiIndex<aiQuestions.length?renderAI():loading();
}

/* loading */
function loading(){
  card.innerHTML=`
    <h3>กำลังประมวลผล...</h3>
    <div class="spinner"></div>
  `;
  setTimeout(lovePage,3500);
}

/* love page */
const loveQuestions=[
"พี่รักหนูไหม",
"ไม่รักจริงๆ หรอ",
"แต่หนูรักพี่นะ",
"รักหนูได้ไหม",
"รักหนูเถอะนะ"
];
let loveIndex=0;
let noCount=0;

function lovePage(){
  document.body.classList.add("love-bg");
  spawnHearts();
  renderLove();
}

function renderLove(){
  card.innerHTML=`
    <h2>${loveQuestions[loveIndex]}</h2>
    <button class="love-btn" onclick="loveYes(this)">รัก</button>
    <button class="no-btn" id="noBtn">ไม่รัก</button>
  `;
  enableEscape();
}

/* หนีเมาส์ real-time */
function enableEscape(){
  const btn=document.getElementById("noBtn");
  card.addEventListener("mousemove",e=>{
    const rect=card.getBoundingClientRect();
    const bx=btn.offsetLeft+btn.offsetWidth/2;
    const by=btn.offsetTop+btn.offsetHeight/2;

    const dx=e.clientX-(rect.left+bx);
    const dy=e.clientY-(rect.top+by);
    const dist=Math.hypot(dx,dy);

    if(dist<120){
      const angle=Math.atan2(dy,dx);
      let x=bx-Math.cos(angle)*120;
      let y=by-Math.sin(angle)*120;

      x=Math.max(0,Math.min(rect.width-btn.offsetWidth,x));
      y=Math.max(0,Math.min(rect.height-btn.offsetHeight,y));

      btn.style.left=x+"px";
      btn.style.top=y+"px";

      noCount++;
      loveIndex=Math.min(loveIndex+1,loveQuestions.length-1);
      if(noCount>=6){
        card.innerHTML="<h2>หนูงอนแล้วนะ</h2>";
      }
    }
  });
}

/* แตกหัวใจตอนกดรัก */
function loveYes(btn){
  const rect=btn.getBoundingClientRect();
  for(let i=0;i<18;i++){
    const h=document.createElement("div");
    h.className="heart";
    h.innerText="❤";
    h.style.left=rect.left+rect.width/2+"px";
    h.style.top=rect.top+rect.height/2+"px";
    h.style.fontSize=22+Math.random()*22+"px";
    h.style.setProperty("--x",(Math.random()*300-150)+"px");
    h.style.setProperty("--y",(Math.random()*300-150)+"px");
    h.style.animation="burst 1.2s ease-out forwards";
    document.body.appendChild(h);
    setTimeout(()=>h.remove(),1200);
  }
  card.innerHTML=`
    <h2>เย่</h2>
    <p>แต่หนูไม่รักพี่</p>
  `;
}
</script>
</body>
</html>
